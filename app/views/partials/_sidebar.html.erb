<!-- Project Navigation Sidebar -->
<nav id="projectSidebar" class="col-md-3 col-lg-2 d-md-block bg-white sidebar collapse border-end">
  <div class="position-sticky p-4">
    <h5 class="fw-bold text-primary mb-4">Project Navigation</h5>
    <ul class="nav flex-column">
      <% if controller_name.in?(%w[project_files project_git project_members]) && defined?(@project) %>
        <li class="nav-item mb-2">
          <%= link_to project_project_files_path(@project, path: ""), class: "nav-link d-flex align-items-center #{controller_name == 'project_files' ? 'active bg-light fw-semibold text-dark' : 'text-muted'}" do %>
            <i class="bi bi-folder2-open me-2"></i> Files
          <% end %>
        </li>
        <li class="nav-item mb-2">
          <%= link_to project_git_path(@project), class: "nav-link d-flex align-items-center #{controller_name == 'project_git' ? 'active bg-light fw-semibold text-dark' : 'text-muted'}" do %>
            <i class="bi bi-git me-2"></i> Version Control
          <% end %>
        </li>
        <% if current_user == @project.owner %>
          <li class="nav-item mb-2">
            <%= link_to project_project_members_path(@project), class: "nav-link d-flex align-items-center #{controller_name == 'project_members' ? 'active bg-light fw-semibold text-dark' : 'text-muted'}" do %>
              <i class="bi bi-people me-2"></i> Members
            <% end %>
          </li>
        <% end %>
      <% end %>

      <!-- Git Panel Section (existing functionality) -->
      <% if controller_name == 'project_git' %>
        <li class="nav-item mt-3 mb-1">
          <hr class="my-2">
          <small class="text-muted fw-bold">GIT PANEL</small>
        </li>
        <li class="nav-item mb-2">
          <%= link_to project_git_path(@project), class: "#{sidebar_link_class('show')} nav-link d-flex align-items-center ps-3" do %>
            <i class="bi bi-clock-history me-2"></i> History
          <% end %>
        </li>
        <li class="nav-item mb-2">
          <%= link_to project_git_branches_path(@project), class: "#{sidebar_link_class('branches')} nav-link d-flex align-items-center ps-3" do %>
            <i class="bi bi-git me-2"></i> Branches
          <% end %>
        </li>
        <li class="nav-item mb-2">
          <%= link_to project_git_branch_commits_path(@project, id: current_branch_id), class: "#{sidebar_link_class('commits')} nav-link d-flex align-items-center ps-3" do %>
            <i class="bi bi-list-ol me-2"></i> Commits
          <% end %>
        </li>
       
        <!-- GitHub Integration Section -->
        <li class="nav-item mt-3 mb-1">
          <hr class="my-2">
          <small class="text-muted fw-bold">GITHUB</small>
        </li>
        <li class="nav-item mb-2">
          <%= link_to github_project_sync_path(@project), class: "#{sidebar_link_class('sync')} nav-link d-flex align-items-center position-relative ps-3" do %>
            <i class="bi bi-github me-2"></i>
            <span>Sync</span>
            <% if !github_token_valid? %>
              <span class="badge bg-warning ms-auto" style="font-size: 0.6rem;">!</span>
            <% elsif @project&.github_url.blank? %>
              <span class="badge bg-info ms-auto" style="font-size: 0.6rem;">Link</span>
            <% else %>
              <span class="badge bg-success ms-auto" style="font-size: 0.6rem;">âœ“</span>
            <% end %>
          <% end %>
        </li>
      <% end %>
    </ul>
  </div>
</nav>

<style>
  .sidebar {
    height: 100vh;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 100;
    padding-top: 48px; /* Adjust based on your header height */
    box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1);
  }

  .sidebar .nav-link {
    border-radius: 0.375rem;
    margin-bottom: 0.25rem;
    transition: all 0.2s ease;
  }

  .sidebar .nav-link:hover {
    background-color: #f8f9fa;
    color: #495057;
  }

  .sidebar .nav-link.active {
    background-color: #e3f2fd;
    color: #1976d2;
    border-left: 3px solid #1976d2;
  }

  .sidebar .nav-link i {
    width: 16px;
    text-align: center;
  }

  @media (max-width: 767.98px) {
    .sidebar {
      top: 5rem;
    }
  }
</style>